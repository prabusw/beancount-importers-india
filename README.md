#  Beancount Importers for Indian Banks and brokers

This repository has few importers for
[Beancount](https://github.com/beancount/beancount), a plain text
accounting software. The available importers are for:

Indian Banks
 - Icici Bank
 - SBI
 - KVB
 - IOB

Stock brokers
- Zerodha - India
- E*Trade - US
- iOCBC - Singapore

## Folder Structure

In beangulp, the importers are called by an import_XXX.py which has
replaced the config.py files used earlier. The example ledger is
prabu.beancount.

![folder
structure](https://github.com/prabusw/beancount-importer-zerodha/blob/master/folderstructure.png)

```
├── importers
│   ├── aniruth
│   │   └── purse.py
│   ├── etrade
│   │   └── etrade.py
│   ├── icici
│   │   └── icici.py
│   ├── iob
│   │   └── iob.py
│   ├── iocbc
│   │   └── iocbc.py
│   ├── kgi
│   │   └── kgi.py
│   ├── kvb
│   │   └── kvb.py
│   ├── rksv
│   │   └── rksv.py
│   ├── sbi
│   │   └── sbi.py
│   └── zerodha
│       |──zerodha.py
|       |──zerodha_xml_importer.py
├── prabu
│   ├── import_prabu.py
│   ├── import_rates.py
│   └── prabu.beancount
├── requirements.txt
└── tools
    └── tsv2csv.sh
```
## Usage

The following command can be used to:

- identify the input file
- extract beancount formatted transactions
- archive the input file in a proper hierarchy

```
$./import_prabu.py [option] Downloads/filename
where option can be identify|extract|archive
```

The above command can be entered without filename. Depending on the
number of matching csv files available in Downloads folder, the
beancount formatted output will be displayed one by one.

For large number of transactions, consider redirecting the output to a
txt file.  From this text file, the transactions can be moved to your
ledger prabu.beancount.

```
$./import_prabu.py extract Downloads/filename > my.txt

```

Smartimporter feature has been enabled for few of the importers to
predict postings and predict payees. Use the below command to train
the smartimporter based on existing entries.

```
$./import_prabu.py extract -e prabu.beancount Downloads/filename > my.txt

```

## Banks

### Icici Bank
When downloading statements from ICICIbank, choose the xls format.
The importer script icici.py can be used to handle the csv formatted
file which can be generated by the xls2csv tool from
[catdoc](https://www.wagner.pp.ru/~vitus/software/catdoc/) package.

The icici importer uses the account number in the downloaded statement and
this must be configured in your importer config file.


### State Bank of India
When downloading SBI transaction statements, if xls is choosen, the
file will be in tsv format even though the file will get downloaded
with .xls extension. Use the tsv2csv.sh script in tools folder to
convert this to csv format.

The sbi importer uses the account number in the downloaded statement and
this must be configured in your importer config file.


### Indian Overseas Bank
The IOB importer works with the csv formatted file(s) downloaded from
bank website, without any modification.

The iob importer requires renaming the csv file as iobNNNN.csv and
this 'NNNN' must be configured in your importer config file.


### Karur Vysya Bank
The KVB importer works with the csv formatted file(s) downloaded from
bank website, without any modification.

The kvb importer uses the account number in the downloaded statement and
this must be configured in your importer config file.


## Brokers

### Zerodha

The first importer 'zerodha.py' works with the csv formatted
'tradebook' downloaded from zerodha backoffice site. Almost every
broker in India, gives similar tradebook and hence can work for every
one of them, with minor changes based on column headings.

Ensure that the csv file is named as zerodhaNNNNNNNN.csv format. For
example, zerodha20232024.csv is a valid filename.

Zerodha backoffice also provides their Contract Notes in multiple
formats. The importer 'zerodha_xml_importer.py' can be used to import
Equity transactions from the xml formatted report. This captures all
the Transaction charges which are not part of the tradebook.

The xml based importer does not impose any naming requirements.

### E*Trade

The csv formatted transaction statement downloaded from E*Trade
website can be used without any modifications using the given
importer. The TransactionType in importer code may need adjustments,
if rows are skipped.

Ensure that the csv file is named as etradeNNNNNNNN.csv format. For
example, etrade20232024.csv is a valid filename.


### iOBCBC

The Singapore broker OCBC securities provide a csv formatted report of
all the trade transaction conducted on their mult-currency
multi-country trading platform iOCBC. The 'iocbc.py' tracks all
options related to currency, exchange etc...

Ensure that the csv file is named as iocbcNNNNNNNN.csv format. For
example, iocbc20232024.csv is a valid filename.

### KGI

The KGI importer is a generic importer which can be used to capture
trade and dividend information manually in a csv file. This csv
entries can then be imported using this importer.

Ensure that the csv file is named as kgiNNNNNNNN.csv format. For
example, kgi20232024.csv is a valid filename.
